<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>客服后台</title>
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" href="../../css/layui.css">
    <script src="../../js/common.js?v=3"></script>
    <link rel="stylesheet" href="../../css/qq.css">
    <style>
        html,body,.mytable {
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        .mytable table.layui-table tbody  td {
            border-top: 1px solid #ccc;
        }
        .overflow:hover{
            background: #9cdffb;
        }
        .overflow {
            padding: 0 10px;
            cursor: pointer;
            font-size: 12px;
        }
        .layui-colla-title {
            height: 32px;
            line-height: 32px;
            color: #2fa9dc;
        }
        .overflow.sel {
            background: #ffd778;
        }
        #tallPanle {
            display: flex;
            display: -webkit-sflex;
            display: -moz-flex;
            display: -ms-flex;
        }
        #tallPanle {
            position: absolute;
            left: 0;
            top: 260px;
            right: 0;
            bottom: 0;
            display: flex;
            display: -webkit-flex;
            display: -moz-flex;
            display: -ms-flex;
        }
        .flex {
            display: flex;
            display: -webkit-flex;
            display: -moz-flex;
            display: -ms-flex;
        }
        .flex_item {
            -webkit-flex: 1;
            -moz-flex: 1;
            -ms-flex: 1;
            flex: 1;
        }
        #ylPage p, #yjPage p {
            height: 18px;
            line-height: 18px;
            margin-top: 5px;
            color: #48a1de;
        }
        #tallPanleCenter {
            -webkit-flex: 1;
            -moz-flex: 1;
            -ms-flex: 1;
            flex: 1;
        }
        #tallPanleLeft {
            width: 300px;
            border-right: 1px solid #ccc;
            /*overflow: auto;*/
        }
        #tallPanleRight {
            width: 300px;
            border-left: 1px solid #ccc;
            overflow: auto;
        }
        .nav_tit {
            height: 36px;
            line-height: 36px;
            text-align: center;
            cursor: pointer;
        }
        .nav_tit span {
            background: url("../../images/nav_bg1.jpg") repeat;
        }
        .nav_tit span.sel {
            background: url("../../images/nav_bg2.jpg") repeat;
        }
        .tab_items {
            height: calc(100% - 36px);
            height: -ms-calc(100% - 36px);
            height: -moz-calc(100% - 36px);
            height: -webkit-calc(100% - 36px);
        }
        .overflow>div {
            overflow: hidden;
            text-overflow:ellipsis;
            white-space: nowrap;
        }
        .mycolla {
            padding: 0;
        }
        .mycolla p {
            padding: 3px 10px 3px 17px;
            overflow: hidden;
            text-overflow:ellipsis;
            white-space: nowrap;
            font-size: 12px;
            cursor: pointer;
        }
        .mycolla p:hover {
            background: #9cdffb;
            color: #fff;
        }
        .font-size {
            position: absolute;
            left: 16px;
            top: 0;
            font-size: 14px;
            line-height: 35px;
            cursor: pointer;
        }
        .font-size {
            transition: all 0.4s ease-in;
            -webkit-transition: all 0.4s ease-in;
            -moz-transition: all 0.4s ease-in;
            -o-transition: all 0.4s ease-in;
            transform: rotate(0);
            -webkit-transform:  rotate(0);
            -moz-transform:  rotate(0);
            -o-transform:  rotate(0);
            -ms-transform:  rotate(0);
        }
        .rotetas {
            line-height: 30px;
            transition: all 0.4s ease-in;
            -webkit-transition: all 0.4s ease-in;
            -moz-transition: all 0.4s ease-in;
            -o-transition: all 0.4s ease-in;
            transform: rotate(180deg);
            -webkit-transform: rotate(180deg);
            -moz-transform: rotate(180deg);
            -o-transform: rotate(180deg);
            -ms-transform: rotate(180deg);
        }
        .tab_item {
            height: 100%;
            overflow: auto;
            /*padding: 10px 5px;*/
            box-sizing:border-box;
            -moz-box-sizing:border-box; /* Firefox */
            -webkit-box-sizing:border-box; /* Safari */
        }
        .none {
            display: none!important;
        }
    </style>
</head>
<body class="layui-layout-body">
    <div class=" mytable layui-layout layui-layout-admin" style="min-width: 980px;">
        <div style="height: 260px;overflow: auto;border:1px solid #c2c2c2;">
            <table class="layui-table" lay-even lay-skin="nob" lay-size="sm" style="margin: 0">
                <thead>
                <tr>
                    <th>类型</th>
                    <th>渠道</th>
                    <th>访客姓名</th>
                    <th>访客次数</th>
                    <th>地域</th>
                    <th>停留时间</th>
                    <th>最后活动</th>
                    <th>来源</th>
                    <th>正在预览页面</th>
                    <th>上次接待</th>
                    <th>当前接待</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody id="visitorTable">
                    <tr><td colspan="12" style="text-align: center  ;">数据加载中……</td></tr>
                    <!--<tr>-->
                        <!--<td>这是类型</td>-->
                        <!--<td>这是渠道</td>-->
                        <!--<td>魔术师</td>-->
                        <!--<td>12</td>-->
                        <!--<td>北京</td>-->
                        <!--<td>2016-11-29 12:12</td>-->
                        <!--<td>活动</td>-->
                        <!--<td>来源这</td>-->
                        <!--<td>http://cnodejs.org/topic/59bf71d3e7d9a031127eacaa</td>-->
                        <!--<td>小客服</td>-->
                        <!--<td>打客服</td>-->
                        <!--<td><button class="layui-btn layui-btn-xs">删除</button></td>-->
                    <!--</tr>-->
                </tbody>
            </table>
        </div>
        <div id="tallPanle">
            <div id="tallPanleLeft">
                <div id="panleLeftTit" class="nav_tit flex">
                    <span class="flex_item sel">对话列表</span>
                    <span class="flex_item">客服</span>
                </div>
                <div id="panleLeftCon" class="tab_items">
                    <div class="tab_item">
                        <div class="list-group">
                            <div class="list-group-item" id="tallList" style="border:none;margin:0;padding:0;">
                                <!--<div class="layui-row overflow" style="height: 30px;line-height: 30px;">-->
                                    <!--<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1"><span style="display: inline-block;color:#fff;width: 20px;height: 20px;line-height:20px;text-align:center;background: #fca44c;border-radius: 50%;">意</span></div>-->
                                    <!--<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">1454545454</div>-->
                                    <!--<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">福建广东省第三方</div>-->
                                    <!--<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1" style="text-align: right;line-height: 32px;"><i class="glyphicon glyphicon-remove"></i></div>-->
                                <!--</div>-->
                                <!--<div class="layui-row overflow" style="height: 30px;line-height: 30px;">-->
                                    <!--<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1"><span style="display: inline-block;color:#fff;width: 20px;height: 20px;line-height:20px;text-align:center;background: #fca44c;border-radius: 50%;">新</span></div>-->
                                    <!--<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">1454545454</div>-->
                                    <!--<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">福建广东省第三方</div>-->
                                    <!--<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1" style="text-align: right;line-height: 32px;"><i class="glyphicon glyphicon-remove"></i></div>-->
                                <!--</div>-->
                            </div>
                        </div>
                    </div>
                    <div class="tab_item none">
                        <div class="list-group">
                            <div class="list-group-item" id="serverList" style="border:none;margin:0;padding:0;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="tallPanleCenter">
                <div class="conRight" style="height: 100%;">
                    <div class="RightCont">
                        <div class="ChatRecord">查看更多消息</div>
                        <ul class="newsList">
                            <li><div class="news"><img class="jiao" src="http://www.argen3630.com:8082/img/talk.jpg">您好！欢迎您访问本网站！</div></li>
                            <li><div class="answers"><img class="jiao" src="http://www.argen3630.com:8082/img/TIM图片20170926103645_03_02.jpg">我想问问？</div></li>
                        </ul>
                    </div>
                    <div class="RightFoot">
                        <div class="emjon">
                            <ul>
                                <li><img src="http://www.argen3630.com:8082/img/1.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/2.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/3.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/4.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/5.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/6.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/7.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/8.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/9.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/10.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/11.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/12.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/13.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/14.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/15.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/16.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/17.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/18.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/19.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/20.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/21.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/22.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/23.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/24.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/25.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/26.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/27.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/28.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/29.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/30.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/31.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/32.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/33.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/34.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/35.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/36.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/37.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/38.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/39.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/40.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/41.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/42.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/43.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/44.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/45.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/46.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/47.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/48.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/49.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/50.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/51.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/52.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/53.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/54.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/55.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/56.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/57.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/58.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/59.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/60.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/50.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/51.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/52.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/53.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/54.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/55.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/56.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/57.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/58.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/59.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/60.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/61.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/62.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/63.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/64.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/65.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/66.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/67.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/68.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/69.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/70.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/71.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/72.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/73.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/74.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/75.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/76.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/77.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/78.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/79.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/80.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/81.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/82.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/83.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/84.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/85.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/86.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/87.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/88.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/89.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/90.gif"></li>
                                <li><img src="http://www.argen3630.com:8082/img/91.gif"></li>
                            </ul>
                        </div>
                        <div class="footTop">
                            <ul>
                                <li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_31.jpg"></li>
                                <li class="ExP"><img class="expimg" src="http://www.argen3630.com:8082/img/TIM图片20170926103645_33.jpg"></li>
                                <!--<li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_35.jpg"></li>-->
                                <!--<li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_37.jpg"></li>-->
                                <!--<li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_39.jpg"></li>-->
                                <!--<li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_41.jpg" alt=""></li>-->
                                <!--<li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_43.jpg"></li>-->
                                <!--<li><img src="http://www.argen3630.com:8082/img/TIM图片20170926103645_45.jpg"></li>-->
                            </ul>
                        </div>
                        <div class="inputBox">
                            <textarea id="dope" style="padding: 5px 10px;width: 99%;height: 70px; border: none;outline: none;" name="" rows="" cols=""></textarea>
                        </div>
                        <div style="text-align: right;padding-right:5px;"><button class="sendBtn">发送(s)</button></div>

                    </div>
                </div>
            </div>
            <div id="tallPanleRight">
                <div id="panleLeftTit" class="nav_tit flex">
                    <span class="flex_item sel">常用语</span>
                    <span class="flex_item">常用文件</span>
                    <span class="flex_item">访客轨迹</span>
                </div>
                <div id="panleLeftCon" class="tab_items">
                    <div class="tab_item">
                        <div class="layui-collapse" id="myCollapse" style="border: none;">
                            <!--<div class="layui-colla-item">-->
                                <!--<h2 class="layui-colla-title">杜甫</h2>-->
                                <!--<div class="layui-colla-content mycolla" style="padding: 0;">-->
                                    <!--<p>我ID撒娇和</p>-->
                                <!--</div>-->
                            <!--</div>-->
                        </div>
                    </div>
                    <div class="tab_item none">
                        <div class="layui-collapse" id="myFileCollapse" style="border: none;">
                            <div class="layui-colla-item">
                                <h2 class="layui-colla-title" style="background: none;">杜甫</h2>
                                <div class="layui-colla-content mycolla" style="padding: 0;border:none;">
                                  <p>我ID撒娇和</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="tab_item none">
                        <div class="layui-collapse" id="myTrajectory" style="border: none;"></div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script src="../../js/jq.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/layui.all.js"></script>
    <script>
        $(function(){
            $(".nav_tit span").on("click", function(){
                var thisIndex = $(this).index();
                console.log(thisIndex);
                $(this).addClass("sel").siblings().removeClass("sel");
                // console.log( $(this).parent().siblings().children());
                $(this).parent().siblings().children(".tab_item").addClass("none").eq(thisIndex).removeClass("none");
            })
            var element = layui.element;

            $(".ExP").on("click", function(){
                $(".emjon").css("display", "block");
            })

            $(document).on("click", function(e){
                console.log();
                var thisDom = $(e.target);
                var isTrue = thisDom.hasClass("expimg");
                if(isTrue) {
                    return;
                }
                console.log();
                $(".emjon").css("display", "none");
            })

            $(".emjon img").on("click", function(){
                var thisUrl = $(this).attr("src");
                console.log(thisUrl);

                var dopeVal = $("#dope").val();
                var isSelectVisitor = $("#tallList .sel").length;
                if(isSelectVisitor == 0) {
                    msgMask("请选择对话人",1);
                    return;
                }
                $(".newsList").append('<li><div class="news"><img class="jiao" src="http://www.argen3630.com:8082/img/talk.jpg"><img src="'+ thisUrl +'"></div></li>')
            })

            var itemListJsonData = [];  // 分组列表数据
            // 分类常用语组列表
            getWordCategoryList()
            function getWordCategoryList(){
                $.ajax({
                    url: urlParam.getWordCategoryList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    success: function (msg) {
                        console.log(msg);
                        var data = msg.data;
                        if(msg.code == 0){
                            var strHTML = "";
                            itemListJsonData = [];

                            if(data.length == 0){
                                strHTML += '<div class="layui-colla-item" style="border:none;">暂无数据</div>';
                                $("#myCollapse").html(strHTML);
                            } else {

                                for(var i = 0; i < data.length; i++) {
                                    var content = data[i].content || "-";
                                    var commonWordListStr = getCommonWordList(data[i].category);
                                    itemListJsonData.push(data[i].category);
//                                var commonWordListStr = getCommonWordList(data[i].category);
                                    strHTML +=
                                        '<div class="layui-colla-item" style="border:none;">'+
                                        '<h2 class="layui-colla-title" style="background: none;"><span class="font-size rotetas"><i class="layui-icon">&#xe61a;</i></span> '+ data[i].category +'</h2>'+
                                        '<div class="layui-colla-content mycolla layui-show" style="padding: 0;border:none;">';
                                    strHTML += commonWordListStr;
                                    strHTML +=
                                        '</div>'+
                                        '</div>'
                                }
                                $("#myCollapse").html(strHTML);
                            }
                        } else {
                            msgMask(msg.message,1)
                        }
                    }

                })
            }
            // 点击rowws
            $(document).on("click", ".layui-colla-title", function(){
                var thisDom = $(this).find(".font-size");
                var siblinsDom = $(this).siblings("div");
                if(thisDom.hasClass("rotetas")) {
                    thisDom.removeClass("rotetas");
                    siblinsDom.removeClass("layui-show");
                } else {
                    thisDom.addClass("rotetas");
                    siblinsDom.addClass("layui-show");
                }
            })
            // 分类常用语列表
            // getCommonWordList()
            function getCommonWordList(category){
                var strHTML = "";
                $.ajax({
                    url: urlParam.getCommonWordList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    async: false,
                    data: {
                        category: category
                    },
                    crossDomain: true,
                    success: function (msg) {
                        console.log(msg);
                        var data = msg.object;
                        if(msg.code == 0){
                            if(data.length == 0){
                                strHTML += '<p>暂无数据</p>';
                            } else {
                                for(var i = 0; i < data.length; i++) {
                                    strHTML += '<p> '+ data[i].content +'</p>';
                                }
                            }
                        } else {
                            msgMask(msg.message,1)
                        }
                    }

                })
                // console.log(strHTML);
                return strHTML;
            }

            // 获取对话列表
            getWaitQueueList()
            function getWaitQueueList(){
                var strHTML = "";
                $.ajax({
                    url: urlParam.getWaitQueueList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    success: function (msg) {
                        var data = msg.object;
                        if(msg.code == 0){
                            if(data.length == 0){
                                strHTML += '<div class="layui-row overflow" style="height: 30px;line-height: 30px;">暂无数据</div>';
                                $("#tallList").html(strHTML)
                            } else {
                                for(var i = 0; i < data.length; i++) {
                                    var status = data[i].status || "-";
                                    var visitor = data[i].visitor || "-";
                                    var visitorId = data[i].visitorid || "-";
                                    var ip = data[i].ip || "-";
                                    strHTML +=
                                        '<div class="layui-row overflow" visitorId="'+ visitorId +'" style="height: 40px;line-height: 40px;">'+
                                            '<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1"><span style="display: inline-block;color:#fff;width: 20px;height: 20px;line-height:20px;text-align:center;background: #fca44c;border-radius: 50%;">'+ status +'</span></div>'+
                                            '<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">'+ visitor +'</div>'+
                                            '<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">'+ ip +'</div>'+
                                            '<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1" style="text-align: right;line-height: 40px;"><i class="glyphicon glyphicon-remove"></i></div>'+
                                        '</div>';
                                }
                                $("#tallList").html(strHTML);
                                getTrajectoryList(data[0].visitorid);
                                getVisitor(data[0].visitorid);
                            }
                        } else {
                            msgMask(msg.message,1)
                        }

                    }
                })
            }

            // 轨迹列表
            function getTrajectoryList(visitorId){
                var visitorId = visitorId || "";
                var strHTML = "";
                $.ajax({
                    url: urlParam.getVisitorLogList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    data: {
                        visitorid: visitorId
                    },
                    success: function (msg) {
                        console.log(msg);
                        var data = msg.data;
                        if(msg.code == 0){
                            if(data.length == 0){
                                strHTML += '<tr><td colspan="12" style="text-align: center">暂无数据</td></tr>';
                                $("#visitorTable").html(strHTML)
                            } else {
                                for(var i = 0; i < data.length; i++) {
                                    var status = (data[i].status == 1) ? "在" : '离';
                                    var role = data[i].role || "-";
                                    var username = data[i].username || "-";
                                    strHTML +=
                                        "<tr>" +
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                            "<td></td>"+
                                        "</tr>";
                                }
                                $("#visitorTable").html(strHTML)
                            }
                        } else {
                            msgMask(msg.message,1)
                        }

                    }
                })
            }
            // 访客轨迹
            function getVisitor(visitorId){
                var visitorId = visitorId || "";
                $.ajax({
                    url: urlParam.getVisitor,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    data: {
                        visitorid: visitorId
                    },
                    success: function (msg) {
                        var strHTML = "";
                        if(msg.code == 0) {
                            // if(msg.object == null || msg.object.length == 0){
                            //     strHTML += "<div style='text-align:center;padding: 10px;' class='layui-row overflow'>暂无数据</div>";
                            // } else {
                                strHTML +=
                                    '<div class="layui-row" style="padding-top:8px;text-indent: 10px;">' +
                                        '<div class="layui-col-xs4 layui-col-sm4 layui-col-md4 layui-col-lg4">历史接待客服</div>'+
                                        '<div class="layui-col-xs8 layui-col-sm8 layui-col-md8 layui-col-lg8">122</div>'+
                                    '</div>'+
                                    '<div class="layui-row" style="padding-top:8px;text-indent: 10px;">' +
                                        '<div class="layui-col-xs4 layui-col-sm4 layui-col-md4 layui-col-lg4">进入时刻</div>'+
                                        '<div class="layui-col-xs8 layui-col-sm8 layui-col-md8 layui-col-lg8">122</div>'+
                                    '</div>'+
                                    '<div style="padding-top:8px;font-size:12px;text-indent: 10px;">' +
                                        '<div>正在浏览页面</div>'+
                                        '<div id="ylPage">' +
                                            '<p>1222</p>' +
                                            '<p>1222</p>' +
                                        '</div>'+
                                    '</div>' +
                                    '<div style="padding-top:8px;font-size:12px;text-indent: 10px;">' +
                                        '<div>已浏览页面</div>'+
                                        '<div id="yjPage">' +
                                            '<p>1222</p>' +
                                            '<p>1222</p>' +
                                        '</div>'+
                                    '</div>'
                            // }
                            $("#myTrajectory").html(strHTML);
                        } else {
                            msgMask(msg.message,1)
                        }

                    }
                })
            }

            // 客服列表
            getMemberList()
            function getMemberList(){
                var strHTML = "";
                $.ajax({
                    url: urlParam.memberList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    success: function (msg) {
                        console.log(msg);
                        var data = msg.data;
                        if(msg.code == 0){
                            if(data.length == 0){
                                strHTML += '<div class="layui-row overflow" style="height: 30px;line-height: 30px;">暂无数据</div>';
                                $("#serverList").html(strHTML)
                            } else {
                                for(var i = 0; i < data.length; i++) {
                                    var status = (data[i].status == 1) ? "在" : '离';
                                    var role = data[i].role || "-";
                                    var username = data[i].username || "-";
                                    strHTML +=
                                        '<div class="layui-row overflow" style="height: 40px;line-height: 40px;">'+
                                        '<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1"><span style="display: inline-block;color:#fff;width: 20px;height: 20px;line-height:20px;text-align:center;background: #fca44c;border-radius: 50%;">'+ status +'</span></div>'+
                                            '<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">'+ role +'</div>'+
                                            '<div class="layui-col-xs5 layui-col-sm5 layui-col-md5 layui-col-lg5">'+ username +'</div>'+
                                            '<div class="layui-col-xs1 layui-col-sm1 layui-col-md1 layui-col-lg1" style="text-align: right;line-height: 40px;"><i class="glyphicon glyphicon-remove"></i></div>'+
                                        '</div>';
                                }
                                $("#serverList").html(strHTML)
                            }
                        } else {
                            msgMask(msg.message,1)
                        }

                    }
                })
            }

            // 常用文件列表
            getFileCategoryList()
            function getFileCategoryList(){
                var strHTML = "";
                $.ajax({
                    url: urlParam.getFileCategoryList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    success: function (msg) {
                        console.log(msg);
                        var data = msg.data;
                        if(msg.code == 0){
                            if(data.length == 0){
                                strHTML += '<div class="layui-colla-item" style="border:none;">暂无数据</div>';
                                $("#myFileCollapse").html(strHTML);
                            } else {

                                for(var i = 0; i < data.length; i++) {
                                    var content = data[i].content || "-";
                                    var commonWordListStr = getCommonFileList(data[i].directory);
                                    itemListJsonData.push(data[i].directory);
//                                var commonWordListStr = getCommonWordList(data[i].category);
                                    strHTML +=
                                        '<div class="layui-colla-item" style="border:none;">'+
                                        '<h2 class="layui-colla-title" style="background: none;"><span class="font-size rotetas"><i class="layui-icon">&#xe61a;</i></span> '+ data[i].directory +'</h2>'+
                                        '<div class="layui-colla-content mycolla layui-show" style="padding: 0;border:none;">';
                                    strHTML += commonWordListStr;
                                    strHTML +=
                                        '</div>'+
                                        '</div>'
                                }
                                $("#myFileCollapse").html(strHTML);
                            }

                        } else {
                            msgMask(msg.message,1)
                        }
                    }

                })
            }

            // 获取常用分类列表文件
            function getCommonFileList(directory){
                var strHTML = "";
                $.ajax({
                    url: urlParam.getCommonFileList,
                    dataType: "json",
                    xhrFields: {
                        withCredentials: true
                    },
                    crossDomain: true,
                    async: false,
                    data:{
                        directory: directory
                    },
                    success: function (msg) {
                        var data = msg.object;
                        if(msg.code == 0){
                            if(data.length == 0){
                                strHTML += '<p>暂无数据</p>';
                            } else {
                                for(var i = 0; i < data.length; i++) {
                                    strHTML += '<p><a href="'+ data[i].path +'" download="'+ data[i].name +'">'+ data[i].name +'</a></p>';
                                }
                            }
                        } else {
                            msgMask(msg.message,1)
                        }
                    }
                })
                return strHTML;
            }

            // 点击对话列表
            $("#tallList").on("click",".overflow", function(){
                var thisVisitorId = $(this).attr("visitorId");
                $(this).addClass('sel').siblings().removeClass("sel");
                getVisitorRecordList(thisVisitorId);
            })
            // 对话记录列表
            function getVisitorRecordList(visitorId){
                $.ajax({
                    url: urlParam.getWaitQueueList,
                    dataType: "json",
                    type: "get",
                    xhrFields: {
                        withCredentials: true
                    },
                    data: {
                        visitorId: visitorId
                    },
                    crossDomain: true,
                    success: function (msg) {
                        console.log(msg)
                        if(msg.code == 0) {

                        } else {
                            msgMask(res.message,1)
                        }
                    }
                })
            }

            // 点击常用语
            $("#myCollapse").on("click", ".layui-colla-content p", function(){
                var thisVal = $(this).text();
                var dopeVal = $("#dope").val();
                var isSelectVisitor = $("#tallList .sel").length;
                if(isSelectVisitor == 0) {
                    msgMask("请选择对话人",1);
                    return;
                }
                if(thisVal == "暂无数据") {
                    return;
                }
                $("#dope").val(dopeVal+ "\n" +thisVal);
            })


        })


    </script>
</body>
</html>