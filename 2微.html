92.
WS  客服  ===>  服务器  通讯协议

客服登录协议：

init  {'type': '消息类型', 'uid': 客服 userid  , 'sign':'签名'}
服务器  回复  {'code':0 , 'msg':'消息说明' , 'data': null }

请求对话协议：
reqTalk {
    'type': 'reqTalk' ,
    'msgId': xxxxx,
    'data' : {
        'fromId':'发起对话请求的客服 userid' ,
        'toId':'被邀请方的客服userId'
    }
}

服务器  回复  {'code':0 , 'msg':'消息说明' , 'msgId':xxxxx, 'data': null }
请求等待用户队列

reqQueueList  {
    'type':'reqQueueList' ,
    'msgId':xxxxx ,
    'data' : {}
} ,

服务器回复  {
'code': 0 , 'msg':'消息说明' ,'msgId':xxxx, 'data': [
{'userid': 'XXXX' , 'companyid':'xxxx' , 'memberid':'xxxx' , 'id': 'xxxx'},
{'userid': 'XXXX' , 'companyid':'xxxx' , 'memberid':'xxxx' , 'id': 'xxxx'},
{'userid': 'XXXX' , 'companyid':'xxxx' , 'memberid':'xxxx' , 'id': 'xxxx'},
{'userid': 'XXXX' , 'companyid':'xxxx' , 'memberid':'xxxx' , 'id': 'xxxx'},
]}


ping  消息 , 服务器主动请求客户端回复

服务器发送   {'type':'ping' }

客服客户端  回复 {'type':'ping'}


chatMsg 消息

客服客户端  请求
{
    'type':'chatMessage' ,
    'msgId':'xxxxxx',
    data : {
        'to': {
            'id': '消息接收方 UserID',
        }
        'mine': {
            'content':'xxxxx',
            'type':'xxxx' , // 文本消息 0 文件消息 1 表情消息 2
        }
    }
}

服务器回复
{
'code': 0 ,
'msg':'消息说明' ,
'msgId':xxxx,
}

93.
WS  访客客户端  ===>  服务器  通讯协议

访客登录协议：

消息类型 init
init  {'type': '消息类型', 'uid': 访客 userid  , 'sign':'签名'}
服务器  回复  {'code':0 , 'msg':'消息说明' , 'data': null }

请求对话协议：

服务器发送给客户端

reqTalk {
    'type': 'reqTalk' ,
    'msgId': xxxxx,
    'data' :
    {
        'fromId':'发起对话请求的客服 userid' ,
        'toId':'被邀请方的客服userId'
    }
}

客户可不回复 或回复
{
'type':'ack',
'msgId': xxxx ,
'code': 0,
'msg':'success',
}




ping  消息 , 服务器主动请求客户端回复

服务器发送   {'type':'ping' }

客服客户端  回复 {'type':'ping'}


chatMsg 消息

客服客户端  请求
{
'type':'chatMessage' ,
'msgId':'xxxxxx',
data : {
'to': {
'id': '消息接收方 UserID',

}
'mine': {
'content':'xxxxx',
'type':'xxxx' , // 文本消息 0 文件消息 1 表情消息 2
}
}
}

服务器回复
{
'code': 0 ,
'msg':'消息说明' ,
'msgId':xxxx,
}